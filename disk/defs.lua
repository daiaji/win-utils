local ffi = require 'ffi'
-- Ensure definitions are loaded
require 'ffi.req' 'Windows.sdk.winioctl'

local M = {}
local C = ffi.C

M.IOCTL = {
    STORAGE_QUERY_PROPERTY         = C.IOCTL_STORAGE_QUERY_PROPERTY,
    STORAGE_GET_DEVICE_NUMBER      = C.IOCTL_STORAGE_GET_DEVICE_NUMBER,
    STORAGE_CHECK_VERIFY           = C.IOCTL_STORAGE_CHECK_VERIFY,
    DISK_GET_DRIVE_GEOMETRY_EX     = C.IOCTL_DISK_GET_DRIVE_GEOMETRY_EX,
    DISK_GET_DRIVE_LAYOUT_EX       = C.IOCTL_DISK_GET_DRIVE_LAYOUT_EX,
    DISK_SET_DRIVE_LAYOUT_EX       = C.IOCTL_DISK_SET_DRIVE_LAYOUT_EX,
    DISK_CREATE_DISK               = C.IOCTL_DISK_CREATE_DISK,
    DISK_UPDATE_PROPERTIES         = C.IOCTL_DISK_UPDATE_PROPERTIES,
    DISK_GET_DISK_ATTRIBUTES       = C.IOCTL_DISK_GET_DISK_ATTRIBUTES,
    DISK_SET_DISK_ATTRIBUTES       = C.IOCTL_DISK_SET_DISK_ATTRIBUTES,
    VOLUME_GET_VOLUME_DISK_EXTENTS = C.VOLUME_GET_VOLUME_DISK_EXTENTS,
    FSCTL_LOCK_VOLUME              = C.FSCTL_LOCK_VOLUME,
    FSCTL_UNLOCK_VOLUME            = C.FSCTL_UNLOCK_VOLUME,
    FSCTL_DISMOUNT_VOLUME          = C.FSCTL_DISMOUNT_VOLUME,
    FSCTL_ALLOW_EXTENDED_DASD_IO   = C.FSCTL_ALLOW_EXTENDED_DASD_IO,
    FSCTL_SHRINK_VOLUME            = C.FSCTL_SHRINK_VOLUME,
    FSCTL_EXTEND_VOLUME            = C.FSCTL_EXTEND_VOLUME,
    MOUNTMGR_SET_AUTO_MOUNT        = C.IOCTL_MOUNTMGR_SET_AUTO_MOUNT,
    MOUNTMGR_QUERY_AUTO_MOUNT      = C.IOCTL_MOUNTMGR_QUERY_AUTO_MOUNT,
    USB_HUB_CYCLE_PORT             = C.IOCTL_USB_HUB_CYCLE_PORT,
}

M.PARTITION_STYLE = {
    MBR = C.PARTITION_STYLE_MBR,
    GPT = C.PARTITION_STYLE_GPT,
    RAW = C.PARTITION_STYLE_RAW
}

M.BUS_TYPE = {
    [0x07] = "USB",
    [0x0B] = "SATA",
    [0x0E] = "Virtual",
    [0x11] = "NVMe"
}

M.DISK_ATTRIBUTE = {
    OFFLINE    = 0x01,
    READ_ONLY  = 0x02
}

return M